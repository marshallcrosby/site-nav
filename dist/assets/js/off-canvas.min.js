/*!
  * Off canvas nav v4.0.0 Beta
  */
class OffCanvasNav{constructor(t){this.nav=t,this.breakpoint=t.getAttribute("data-oc-breakpoint"),this.menu=t.querySelector("[data-oc-menu]"),this.overlay=t.querySelector("[data-oc-overlay]")||document.querySelector("[data-oc-overlay]"),this.toggleButton=t.querySelector("[data-oc-toggle]"),this.closeButton=t.querySelector("[data-oc-close]"),this.keyboardHandler=null,this.previouslyFocusedElement=null,this.swipeable=t.hasAttribute("data-oc-swipe"),this.touchStartX=0,this.touchStartY=0,this.touchCurrentX=0,this.touchCurrentY=0,this.isDragging=!1,this.swipeThreshold=50,this.swipeVelocityThreshold=.3,this.snapThreshold=.5,this.isGestureInProgress=!1,this.gestureStartPosition=0,this.setupEventListeners()}setupEventListeners(){this.toggleButton&&this.toggleButton.addEventListener("click",()=>this.toggleMenu()),this.closeButton&&this.closeButton.addEventListener("click",()=>this.closeMenu()),this.overlay&&this.overlay.addEventListener("click",()=>this.closeMenu()),document.addEventListener("keydown",t=>{"Escape"===t.key&&this.isMenuOpen()&&this.closeMenu()}),window.addEventListener("resize",()=>{this.isDesktopView()?(this.closeMenu(),this.makeMenuAccessible()):this.updateAccessibilityForCurrentState()}),this.swipeable&&this.setupSwipeListeners(),this.updateAccessibilityForCurrentState()}getMenuWidth(){let t=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--oc-menu-width"),10);if(isNaN(t)){const e=getComputedStyle(document.documentElement).getPropertyValue("--oc-menu-width").trim();if(e.endsWith("vw")){const s=parseFloat(e);t=Math.round(window.innerWidth*(s/100))}else if(e.startsWith("calc(")){const s=e.match(/calc\((\d+)(vw)\s*-\s*(\d+)px\)/);if(s){const e=parseFloat(s[1]),i=parseInt(s[3],10);t=Math.round(window.innerWidth*(e/100))-i}}}return t}isMenuOnRight(){return this.menu.classList.contains("oc-nav__menu--right")}setMenuTransform(t){const e=this.isMenuOnRight(),s=this.getMenuWidth();if(t=e?Math.min(0,Math.max(-s,t)):Math.max(0,Math.min(s,t)),this.menu.style.transform=`translateX(${t}px)`,this.overlay){const e=Math.abs(t)/s;this.overlay.style.opacity=e,this.overlay.style.visibility=e>0?"visible":"hidden"}}resetMenuTransform(){this.menu.style.transform="",this.overlay&&(this.overlay.style.opacity="",this.overlay.style.visibility="")}setupSwipeListeners(){document.addEventListener("touchstart",t=>this.handleTouchStart(t),{passive:!0}),document.addEventListener("touchmove",t=>this.handleTouchMove(t),{passive:!1}),document.addEventListener("touchend",t=>this.handleTouchEnd(t),{passive:!0})}handleTouchStart(t){this.isMobileView()&&this.isMenuOpen()&&(this.touchStartX=t.touches[0].clientX,this.touchStartY=t.touches[0].clientY,this.touchCurrentX=this.touchStartX,this.touchCurrentY=this.touchStartY,this.isDragging=!1,this.isGestureInProgress=!1,this.swipeStartTime=Date.now(),this.menu.removeAttribute("inert"))}handleTouchMove(t){if(!this.isMobileView()||!this.isMenuOpen())return;this.touchCurrentX=t.touches[0].clientX,this.touchCurrentY=t.touches[0].clientY;const e=this.touchCurrentX-this.touchStartX,s=this.touchCurrentY-this.touchStartY;if(Math.abs(e)>Math.abs(s)&&Math.abs(e)>10){const s=this.isMenuOnRight();if(s?e>0:e<0){this.isDragging=!0,this.isGestureInProgress=!0,t.preventDefault();const i=this.getMenuWidth();let n;n=s?-i+e:i+e,this.setMenuTransform(n)}}}handleTouchEnd(t){if(!this.isMobileView()||!this.isDragging||!this.isMenuOpen())return;const e=this.touchCurrentX-this.touchStartX,s=this.touchCurrentY-this.touchStartY,i=Date.now()-this.swipeStartTime,n=Math.abs(e)/i;if(Math.abs(e)>Math.abs(s)){const t=this.isMenuOnRight(),s=this.getMenuWidth(),i=Math.abs(e)/s;let o=!1;o=n>this.swipeVelocityThreshold?t?e>0:e<0:i>this.snapThreshold,this.menu.style.transition="transform 300ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",o?this.snapToClose():this.snapToOpen(),setTimeout(()=>{this.menu.style.transition=""},300)}this.isDragging=!1,this.isGestureInProgress=!1}snapToOpen(){const t=this.isMenuOnRight(),e=this.getMenuWidth();t?this.setMenuTransform(-e):this.setMenuTransform(e),setTimeout(()=>{this.resetMenuTransform()},300)}snapToClose(){this.setMenuTransform(0),this.menu.classList.remove("show"),this.overlay&&this.overlay.classList.remove("show"),this.toggleButton.setAttribute("aria-expanded","false"),this.closeButton.setAttribute("aria-expanded","false"),document.body.style.overflow="",this.updateAccessibilityForCurrentState(),this.removeKeyboardNavigation(),setTimeout(()=>{this.resetMenuTransform()},300)}toggleMenu(){this.isMenuOpen()?(this.toggleButton.setAttribute("aria-expanded","false"),this.closeButton.setAttribute("aria-expanded","false"),this.closeMenu()):(this.toggleButton.setAttribute("aria-expanded","true"),this.closeButton.setAttribute("aria-expanded","true"),this.openMenu())}openMenu(){this.toggleButton.setAttribute("aria-expanded","true"),this.closeButton.setAttribute("aria-expanded","true");const t=new CustomEvent("show.offCanvas");document.dispatchEvent(t),this.menu.classList.add("show"),this.overlay&&this.overlay.classList.add("show"),document.body.style.overflow="hidden",this.updateAccessibilityForCurrentState(),this.setupKeyboardNavigation(),this.menu.addEventListener("transitionend",()=>{const t=new CustomEvent("shown.offCanvas");document.dispatchEvent(t)},{once:!0})}closeMenu(){this.toggleButton.setAttribute("aria-expanded","false"),this.closeButton.setAttribute("aria-expanded","false");const t=new CustomEvent("hide.offCanvas");document.dispatchEvent(t),this.menu.classList.remove("show"),this.overlay&&this.overlay.classList.remove("show"),document.body.style.overflow="",this.updateAccessibilityForCurrentState(),this.removeKeyboardNavigation(),this.menu.addEventListener("transitionend",()=>{const t=new CustomEvent("hidden.offCanvas");document.dispatchEvent(t)},{once:!0})}isMenuOpen(){return this.menu.classList.contains("show")}isDesktopView(){return window.matchMedia(`(min-width: ${parseInt(this.breakpoint)}px)`).matches}isMobileView(){return window.matchMedia(`(max-width: ${parseInt(this.breakpoint)-1}px)`).matches}isElementVisible(t){const e=window.getComputedStyle(t);return"none"!==e.display&&"hidden"!==e.visibility&&null!==t.offsetParent}getFocusableElements(t){return Array.from(t.querySelectorAll(["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","object","embed",'[tabindex="0"]',"[contenteditable]"].join(","))).filter(t=>this.isElementVisible(t)&&t.tabIndex>=0)}setupKeyboardNavigation(){this.previouslyFocusedElement=document.activeElement,this.keyboardHandler=t=>{if("Escape"===t.key)return t.preventDefault(),void this.closeMenu();if("Tab"===t.key){const e=this.getFocusableElements(this.menu),s=e[0],i=e[e.length-1];if(0===e.length)return void t.preventDefault();t.shiftKey&&document.activeElement===s?(t.preventDefault(),i.focus()):t.shiftKey||document.activeElement!==i||(t.preventDefault(),s.focus())}},this.menu.addEventListener("keydown",this.keyboardHandler);const t=this.getFocusableElements(this.menu)[0];t&&t.focus()}removeKeyboardNavigation(){this.keyboardHandler&&(this.menu.removeEventListener("keydown",this.keyboardHandler),this.keyboardHandler=null),this.previouslyFocusedElement&&this.previouslyFocusedElement.focus()}updateAccessibilityForCurrentState(){this.isMenuOpen()&&this.isMobileView()||!this.isMobileView()?this.makeMenuAccessible():this.makeMenuInaccessible()}makeMenuAccessible(){this.menu.removeAttribute("inert")}makeMenuInaccessible(){this.menu.setAttribute("inert","true")}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".oc-nav").forEach(t=>new OffCanvasNav(t))});//# sourceMappingURL=off-canvas.min.js.map
